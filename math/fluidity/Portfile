# $Id$

PortSystem	1.0

name		fluidity
version     4.1.6
categories  math science
maintainers	jrper
description	Fluidity Navier-Stokes solver

conflicts petsc

platforms	darwin
homepage	http://www.amcg.ese.ic.ac.uk
master_sites	file:///Users/origimbo/fluidity
distname	fluidity-darwin-port
worksrcdir	fluidity-darwin-port
universal_variant   no

checksums           md5 91476eedd5c1b4348bd2aa4f44e6430e\
		    sha1 22fe3864cf0889e596649028d5baafa88449dc32

depends_lib-append  port:openmpi port:gcc46 port:petsc-fluidity\
		    port:zoltan-fluidity port:vtk5 port:gmsh-devel\


configure.env-append      OMPI_CXX=${prefix}/bin/g++-mp-4.7\
	       OMPI_CC=${prefix}/bin/gcc-mp-4.7\
	       OMPI_FC=${prefix}/bin/gfortran-mp-4.7\
	       PETSC_DIR=${prefix}/lib/petsc

configure.compiler macports-gcc-4.7

configure.cc    ${prefix}/lib/openmpi/bin/mpicc
configure.cxx   ${prefix}/lib/openmpi/bin/mpicxx
configure.fc    ${prefix}/lib/openmpi/bin/mpif90
configure.f77   ${prefix}/lib/openmpi/bin/mpif90
configure.ldflags-append -L${prefix}/lib/petsc/lib\
			  -L${prefix}/lib/vtk-5.10\
configure.fcflags-append -I${prefix}/include\
			 -I${prefix}/include/vtk-5.10\
			 -I${prefix}/lib/petsc/include
configure.cxxflags-append -I${prefix}/include/vtk-5.10\
			  -I${prefix}/lib/petsc/include

configure.args 		--enable-2d-adaptivity\
		--with-blas-dir=${prefix}/lib/petsc\
		--with-lapack-dir=${prefix}/lib/petsc\
		--with-ParMetis=${prefix}/lib/petsc


build.env-append      OMPI_CXX=${prefix}/bin/g++-mp-4.7\
	       OMPI_CC=${prefix}/bin/gcc-mp-4.7\
	       OMPI_FC=${prefix}/bin/gfortran-mp-4.7\



destroot.destdir DESTDIR=${destroot}${prefix}/fluidity
